#!/bin/bash

mkdir $2 

cat $1 | grep -a2 -E "@GET|@POST|@PUT|@PATCH|@DELETE|@OPTIONS"  > $2/detailsAPI.txt

cat $1 | grep -a2 -E "@GET|@POST|@PUT|@PATCH|@DELETE|@OPTIONS" | awk -F'"' '{print $2}' | sort -u  > $2/listAPI.txt

cat $2/detailsAPI.txt | grep -v -E "@GET|@POST|@PUT|@PATCH|@DELETE|@OPTIONS|@Header" | awk -F'"' 'OFS="\n" {print $2,$4,$6,$8,$10,$12,$14,$16,$18,$20,$22,$24,$26,$28,$30,$32,$34,$36,$38,$40,$42,$44,$46,$48,$50}' | sort -u > $2/paramsAPI.txt

input="$2/paramsAPI.txt"
while IPS= read -r line
do
	echo "&$line=1" >> $2/bodyParam.txt
done < "$input"
