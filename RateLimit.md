# Rate Limit

## Where to find:
- Register, Login, Reset password
- 2FA/OTP
- Sending messages or GIFs, sending codes, comments, etc

## Bypass
- Identifying what the rate limit is based on
  - IP
  - Email/Mobile number/username
  - Session ID
  - URL path
- Find a way to bypass

## 1. Using Header

- Use the following Header:

```
X-Forwarded: 127.0.0.1
X-Forwarded-By: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Forwarded-For-Original: 127.0.0.1
X-Forwarder-For: 127.0.0.1
X-Forward-For: 127.0.0.1
Forwarded: 127.0.0.1
Forwarded-For: 127.0.0.1
Forwarded-For-Ip: 127.0.0.1
X-Originating-IP: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Custom-IP-Authorization: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1
True-Client-IP: 127.0.0.1
X-Real-IP: 127.0.0.1
```
- Use double X-Forwarded-For header:

```
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```

-Tool: BypassWAF Burp extension

## 2. Using special characters

- Add Space Character (Not encoded) or Null Byte (%00) at the end of the email 
- Add following characters: %0d, %0a, %0d%0a, %09, %0C, %2e, %20, %0 on email
- Add a slash (/) at the end of api endpoint
```api/v1/login``` -> ```api/v1/login/```

## 3. Changing ```User-Agent```, ```Cookies```, or ```IP```

- Tool: IP-Rotate Burp extension

## 4. Changing HTTP Methods

- If the request uses GET method -> change it to POST, PUT, etc
- Bypass rate limit in API -> try HEAD method

## 5. Using similar parameters

- Eg: Rate limit is on ```api/v1/login```
-> Change ```login``` to ```LogIn```, ```log-in```, ```Log-In```

## 6. MISC

- Request has a CAPTCHA parameter -> Remove it to bypass
- Send a request -> Intercept ON, no forward -> Send the request to Intruder -> Start attack -> Bypass
- ASCII encoding: ```test@email.com``` -> ```t%65st@em%61il.com```
- Try HTTP Paramter Pollution: 
```api/v1/login/?email=asdf@mail.com&email=bypass@mail.com```
- URL manipulation:
```
Examples:
/path/login/
/path/login/?para
/path/login/../
/pAth/lOgIN/
```    

## Reference

- https://kathan19.gitbook.io/howtohunt/rate-limit/ratelimitbypass
- https://huzaifa-tahir.medium.com/methods-to-bypass-rate-limit-5185e6c67ecd 
- https://twitter.com/m4ll0k/status/1294983599943540738
- [Bypass using Incepter ON](https://shahjerry33.medium.com/no-rate-limit-2k-bounty-642720ffba99)
- https://medium.com/@jeppe.b.weikop/techniques-for-bypassing-rate-limiting-on-otp-2fa-endpoints-2a7dc93ed262

